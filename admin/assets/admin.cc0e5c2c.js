import{r as V,a2 as J,ai as t,o as s,c as x,a as y,Z as e,T as o,X as C,S as w,u,Y as $,F as L,p as U,aa as P,V as F,P as z,I as Q,ay as ee,az as oe,$ as te,aA as ne}from"./@vue.81e65c16.js";import{_ as ae}from"./FormDrawer.bf3acaa6.js";import{q as le,p as se}from"./@vueuse.d6949a36.js";import{u as re,t as E,s as de,l as ue,r as ce}from"./index.73635d93.js";import{u as W,b as M,o as N}from"./vue-router.fe3267df.js";import{u as q}from"./vuex.5f15401c.js";import{_ as _e}from"./_plugin-vue_export-helper.cdc0426e.js";import"./universal-cookie.9008d64e.js";import"./cookie.ccf51230.js";import"./element-plus.aff2968d.js";import"./lodash-es.759d0354.js";import"./@element-plus.0ddfaa13.js";import"./@popperjs.36402333.js";import"./@ctrl.b082b0c1.js";import"./dayjs.8ff0c08c.js";import"./axios.23bc5756.js";import"./async-validator.fb49d0f5.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@floating-ui.4bc9703a.js";import"./nprogress.18e92d20.js";function pe(){const m=W(),r=q(),l=V(null),a=J({oldpassword:"",password:"",repassword:""}),d={oldpassword:[{required:!0,message:"\u65E7\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{required:!0,message:"\u65B0\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],repassword:[{required:!0,message:"\u786E\u8BA4\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]},v=V(null);return{formDrawerRef:l,form:a,rules:d,formRef:v,onSubmit:()=>{v.value.validate(f=>{if(!f)return!1;l.value.showLoading(),re(a).then(n=>{E("\u4FEE\u6539\u5BC6\u7801\u6210\u529F\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55"),r.dispatch("logout"),m.push("/login")}).finally(()=>{l.value.hideLoading()})})},openRePasswordForm:()=>l.value.open()}}function ie(){const m=W(),r=q();function l(){de("\u662F\u5426\u8981\u9000\u51FA\u767B\u5F55\uFF1F").then(a=>{ue().finally(()=>{r.dispatch("logout"),m.push("/login"),E("\u9000\u51FA\u767B\u5F55\u6210\u529F")})})}return{handleLogout:l}}const me={class:"f-header"},fe={class:"logo"},he={class:"ml-auto flex items-center"},we={class:"flex items-center text-light-50"},ve={__name:"FHeader",setup(m){const{isFullscreen:r,toggle:l}=le(),{formDrawerRef:a,form:d,rules:v,formRef:k,onSubmit:g,openRePasswordForm:f}=pe(),{handleLogout:n}=ie(),c=p=>{switch(p){case"logout":n();break;case"rePassword":f();break}},b=()=>location.reload();return(p,i)=>{const _=t("eleme-filled"),h=t("el-icon"),R=t("fold"),S=t("Expand"),O=t("refresh"),B=t("el-tooltip"),H=t("full-screen"),K=t("aim"),X=t("el-avatar"),Y=t("arrow-down"),D=t("el-dropdown-item"),Z=t("el-dropdown-menu"),j=t("el-dropdown"),A=t("el-input"),I=t("el-form-item"),G=t("el-form");return s(),x(L,null,[y("div",me,[y("span",fe,[e(h,{class:"mr-1"},{default:o(()=>[e(_)]),_:1}),C(" \u7535\u5546\u540E\u53F0 ")]),e(h,{class:"icon-btn",onClick:i[0]||(i[0]=T=>p.$store.commit("handleAsideWidth"))},{default:o(()=>[p.$store.state.asideWidth=="250px"?(s(),w(R,{key:0})):(s(),w(S,{key:1}))]),_:1}),e(B,{effect:"dark",content:"\u5237\u65B0",placement:"bottom"},{default:o(()=>[e(h,{class:"icon-btn",onClick:b},{default:o(()=>[e(O)]),_:1})]),_:1}),y("div",he,[e(B,{effect:"dark",content:"\u5168\u5C4F",placement:"bottom"},{default:o(()=>[e(h,{class:"icon-btn",onClick:u(l)},{default:o(()=>[u(r)?(s(),w(K,{key:1})):(s(),w(H,{key:0}))]),_:1},8,["onClick"])]),_:1}),e(j,{class:"dropdown",onCommand:c},{dropdown:o(()=>[e(Z,null,{default:o(()=>[e(D,{command:"rePassword"},{default:o(()=>[C("\u4FEE\u6539\u5BC6\u7801")]),_:1}),e(D,{command:"logout"},{default:o(()=>[C("\u9000\u51FA\u767B\u5F55")]),_:1})]),_:1})]),default:o(()=>[y("span",we,[e(X,{class:"mr-2",size:25,src:p.$store.state.user.avatar},null,8,["src"]),C(" "+$(p.$store.state.user.username)+" ",1),e(h,{class:"el-icon--right"},{default:o(()=>[e(Y)]),_:1})])]),_:1})])]),e(ae,{ref_key:"formDrawerRef",ref:a,title:"\u4FEE\u6539\u5BC6\u7801",destroyOnClose:"",onSubmit:u(g)},{default:o(()=>[e(G,{ref_key:"formRef",ref:k,rules:u(v),model:u(d),"label-width":"80px",size:"small"},{default:o(()=>[e(I,{prop:"oldpassword",label:"\u65E7\u5BC6\u7801"},{default:o(()=>[e(A,{modelValue:u(d).oldpassword,"onUpdate:modelValue":i[1]||(i[1]=T=>u(d).oldpassword=T),placeholder:"\u8BF7\u8F93\u5165\u65E7\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),e(I,{prop:"password",label:"\u65B0\u5BC6\u7801"},{default:o(()=>[e(A,{type:"password",modelValue:u(d).password,"onUpdate:modelValue":i[2]||(i[2]=T=>u(d).password=T),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801","show-password":""},null,8,["modelValue"])]),_:1}),e(I,{prop:"repassword",label:"\u786E\u8BA4\u5BC6\u7801"},{default:o(()=>[e(A,{type:"password",modelValue:u(d).repassword,"onUpdate:modelValue":i[3]||(i[3]=T=>u(d).repassword=T),placeholder:"\u8BF7\u8F93\u5165\u786E\u8BA4\u5BC6\u7801","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["onSubmit"])],64)}}};const be={__name:"FMenu",setup(m){const r=W(),l=q(),a=M(),d=V(a.path);N((f,n)=>{d.value=f.path});const v=U(()=>l.state.asideWidth!="250px"),k=U(()=>l.state.menus),g=f=>{r.push(f)};return(f,n)=>{const c=t("el-icon"),b=t("el-menu-item"),p=t("el-sub-menu"),i=t("el-menu");return s(),x("div",{class:"f-menu",style:z({width:f.$store.state.asideWidth})},[e(i,{"default-active":d.value,"unique-opened":"",collapse:u(v),class:"border-0",onSelect:g,"collapse-transition":!1},{default:o(()=>[(s(!0),x(L,null,P(u(k),(_,h)=>(s(),x(L,{key:h},[_.child&&_.child.length>0?(s(),w(p,{key:0,index:_.name},{title:o(()=>[e(c,null,{default:o(()=>[(s(),w(F(_.icon)))]),_:2},1024),y("span",null,$(_.name),1)]),default:o(()=>[(s(!0),x(L,null,P(_.child,(R,S)=>(s(),w(b,{key:S,index:R.frontpath},{default:o(()=>[e(c,null,{default:o(()=>[(s(),w(F(R.icon)))]),_:2},1024),y("span",null,$(R.name),1)]),_:2},1032,["index"]))),128))]),_:2},1032,["index"])):(s(),w(b,{key:1,index:_.frontpath},{default:o(()=>[e(c,null,{default:o(()=>[(s(),w(F(_.icon)))]),_:2},1024),y("span",null,$(_.name),1)]),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active","collapse"])],4)}}};function ge(){const m=M(),r=se(),l=V(m.path),a=V([{title:"\u540E\u53F0\u9996\u9875",path:"/"}]);function d(n){a.value.findIndex(b=>b.path==n.path)==-1&&a.value.push(n),r.set("tabList",a.value)}function v(){let n=r.get("tabList");n&&(a.value=n)}return v(),N((n,c)=>{l.value=n.path,d({title:n.meta.title,path:n.path})}),{activeTab:l,tabList:a,changeTab:n=>{console.log(m.path),l.value=n,ce.push(n)},removeTab:n=>{let c=a.value,b=l.value;b==n&&c.forEach((p,i)=>{if(p.path==n){const _=c[i+1]||c[i-1];_&&(b=_.path)}}),l.value=b,a.value=a.value.filter(p=>p.path!=n),r.set("tabList",a.value)},handleClose:n=>{n=="clearAll"?(l.value="/",a.value=[{title:"\u540E\u53F0\u9996\u9875",path:"/"}]):n=="clearOther"&&(a.value=a.value.filter(c=>c.path=="/"||c.path==l.value)),r.set("tabList",a.value)}}}const ye=m=>(ee("data-v-a9799450"),m=m(),oe(),m),ke={class:"tag-btn"},xe={class:"el-dropdown-link"},Te=ye(()=>y("div",{style:{height:"44px"}},null,-1)),Ce={__name:"FTagList",setup(m){const{activeTab:r,tabList:l,changeTab:a,removeTab:d,handleClose:v}=ge();return(k,g)=>{const f=t("el-tab-pane"),n=t("el-tabs"),c=t("arrow-down"),b=t("el-icon"),p=t("el-dropdown-item"),i=t("el-dropdown-menu"),_=t("el-dropdown");return s(),x(L,null,[y("div",{class:"f-tag-list",style:z({left:k.$store.state.asideWidth})},[e(n,{modelValue:u(r),"onUpdate:modelValue":g[0]||(g[0]=h=>Q(r)?r.value=h:null),type:"card",class:"flex-1",onTabRemove:u(d),style:{"min-width":"100px"},onTabChange:u(a)},{default:o(()=>[(s(!0),x(L,null,P(u(l),h=>(s(),w(f,{closable:h.path!="/",key:h.path,label:h.title,name:h.path},null,8,["closable","label","name"]))),128))]),_:1},8,["modelValue","onTabRemove","onTabChange"]),y("span",ke,[e(_,{onCommand:u(v)},{dropdown:o(()=>[e(i,null,{default:o(()=>[e(p,{command:"clearOther"},{default:o(()=>[C("\u5173\u95ED\u5176\u4ED6")]),_:1}),e(p,{command:"clearAll"},{default:o(()=>[C("\u5168\u90E8\u5173\u95ED")]),_:1})]),_:1})]),default:o(()=>[y("span",xe,[e(b,null,{default:o(()=>[e(c)]),_:1})])]),_:1},8,["onCommand"])])],4),Te],64)}}},Le=_e(Ce,[["__scopeId","data-v-a9799450"]]);const Ze={__name:"admin",setup(m){return(r,l)=>{const a=t("el-header"),d=t("el-aside"),v=t("router-view"),k=t("el-main"),g=t("el-container");return s(),w(g,null,{default:o(()=>[e(a,null,{default:o(()=>[e(ve)]),_:1}),e(g,null,{default:o(()=>[e(d,{width:r.$store.state.asideWidth},{default:o(()=>[e(be)]),_:1},8,["width"]),e(k,null,{default:o(()=>[e(Le),e(v,null,{default:o(({Component:f})=>[e(te,{name:"fade"},{default:o(()=>[(s(),w(ne,{max:10},[(s(),w(F(f)))],1024))]),_:2},1024)]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Ze as default};
