import{_ as Be}from"./ListHeader.3c627458.js";import{_ as se}from"./FormDrawer.bf3acaa6.js";import{_ as ue}from"./ChooseImage.4aaac2ad.js";import{_ as Ne,a as ve}from"./SearchItem.584b0c12.js";import{r as de,s as Ae,u as Ve,c as Oe,a as Fe,d as Ee,b as je,e as Me,f as He,g as Je,h as qe,i as Pe,j as Ke,k as Ye,l as We,m as Xe,n as Ze,o as Qe,p as el}from"./category.6f92cdbf.js";import{t as Z,c as ll,b as tl,d as al}from"./index.73635d93.js";import{r as V,a2 as Q,ai as d,o as m,S as U,T as t,Z as e,X as k,w as be,c as h,u as a,F as $,p as ye,n as ol,as as re,U as X,aa as A,I as nl,ab as sl,a as x,O as ul,Y as B,W}from"./@vue.81e65c16.js";import{t as dl}from"./tinymce.3992270d.js";import{E as rl}from"./@tinymce.a74df7f9.js";import{g as il}from"./skus.bc15ff22.js";import{u as Ce,a as cl}from"./useCommon.39802c06.js";import"./ImageMain.fdfef588.js";import"./element-plus.aff2968d.js";import"./lodash-es.759d0354.js";import"./@vueuse.d6949a36.js";import"./universal-cookie.9008d64e.js";import"./cookie.ccf51230.js";import"./@element-plus.0ddfaa13.js";import"./@popperjs.36402333.js";import"./@ctrl.b082b0c1.js";import"./dayjs.8ff0c08c.js";import"./axios.23bc5756.js";import"./async-validator.fb49d0f5.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@floating-ui.4bc9703a.js";import"./vue-router.fe3267df.js";import"./vuex.5f15401c.js";import"./nprogress.18e92d20.js";const ml={__name:"banners",emits:["reloadData"],setup(r,{expose:p,emit:u}){const o=V(!1),l=Q({banners:[]}),y=V(0),g=v=>{y.value=v.id,v.bannersLoading=!0,de(y.value).then(i=>{l.banners=i.goodsBanner.map(f=>f.url),o.value=!0}).finally(()=>{v.bannersLoading=!1})},b=V(!1),s=()=>{b.value=!0,Ae(y.value,l).then(v=>{Z("\u8BBE\u7F6E\u8F6E\u64AD\u56FE\u6210\u529F"),o.value=!1,u("reloadData")}).finally(()=>{b.value=!1})};return p({open:g}),(v,i)=>{const f=d("el-form-item"),C=d("el-button"),z=d("el-form"),w=d("el-drawer");return m(),U(w,{title:"\u8BBE\u7F6E\u8F6E\u64AD\u56FE",modelValue:o.value,"onUpdate:modelValue":i[1]||(i[1]=G=>o.value=G),size:"50%","destroy-on-close":""},{default:t(()=>[e(z,{model:l,"label-width":"80px"},{default:t(()=>[e(f,{label:"\u8F6E\u64AD\u56FE"},{default:t(()=>[e(ue,{limit:9,modelValue:l.banners,"onUpdate:modelValue":i[0]||(i[0]=G=>l.banners=G)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(C,{type:"primary",onClick:s,loading:b.value},{default:t(()=>[k("\u63D0\u4EA4")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};const pl={__name:"Editor",props:{modelValue:String},emits:["update:modelValue"],setup(r,{emit:p}){const u=r,o=V(null),l={language_url:"/tinymce/langs/zh-Hans.js",language:"zh-Hans",skin_url:"/tinymce/skins/ui/oxide",content_css:"/tinymce/skins/content/default/content.min.css",menubar:!1,autoresize_bottom_margin:50,max_height:500,min_height:400,toolbar_mode:"none",plugins:"wordcount visualchars visualblocks template searchreplace save quickbars preview pagebreak nonbreaking media insertdatetime importcss image help fullscreen directionality codesample code charmap link code table lists advlist anchor autolink autoresize autosave",toolbar:"formats undo redo fontsizeselect fontselect ltr rtl searchreplace media imageUpload | outdent indent aligncenter alignleft alignright alignjustify lineheight underline quicklink h2 h3 blockquote numlist bullist table removeformat forecolor backcolor bold italic strikethrough hr link preview fullscreen help ",content_style:"p {margin: 5px 0; font-size: 14px}",fontsize_formats:"12px 14px 16px 18px 24px 36px 48px 56px 72px",font_formats:"\u5FAE\u8F6F\u96C5\u9ED1=Microsoft YaHei,Helvetica Neue,PingFang SC,sans-serif;\u82F9\u679C\u82F9\u65B9 = PingFang SC, Microsoft YaHei, sans- serif; \u5B8B\u4F53 = simsun, serif; \u4EFF\u5B8B\u4F53 =  FangSong, serif; \u9ED1\u4F53 = SimHei, sans - serif; Arial = arial, helvetica, sans - serif;Arial Black = arial black, avant garde;Book Antiqua = book antiqua, palatino; ",branding:!1,elementpath:!1,resize:!1,statusbar:!1,setup:g=>{g.ui.registry.addButton("imageUpload",{tooltip:"\u63D2\u5165\u56FE\u7247",icon:"image",onAction(){o.value.open(b=>{b.forEach(s=>{g.insertContent(`<img src="${s}" style="width:100%;"/>`)})})}})}};dl.init;const y=V(u.modelValue);return be(u,g=>y.value=g.modelValue),be(y,g=>p("update:modelValue",g)),(g,b)=>(m(),h($,null,[e(a(rl),{modelValue:y.value,"onUpdate:modelValue":b[0]||(b[0]=s=>y.value=s),"tag-name":"div",init:l},null,8,["modelValue"]),e(ue,{preview:!1,ref_key:"ChooseImageRef",ref:o,limit:9},null,512)],64))}},_l={__name:"content",emits:["reloadData"],setup(r,{expose:p,emit:u}){const o=V(null),l=Q({content:""}),y=V(0),g=s=>{y.value=s.id,s.contentLoading=!0,de(y.value).then(v=>{l.content=v.content,o.value.open()}).finally(()=>{s.contentLoading=!1})},b=()=>{o.value.showLoading(),Ve(y.value,l).then(s=>{Z("\u8BBE\u7F6E\u5546\u54C1\u8BE6\u60C5\u6210\u529F"),o.value.close(),u("reloadData")}).finally(()=>{o.value.hideLoading()})};return p({open:g}),(s,v)=>{const i=d("el-form-item"),f=d("el-form");return m(),U(se,{ref_key:"formDrawerRef",ref:o,title:"\u8BBE\u7F6E\u5546\u54C1\u8BE6\u60C5",onSubmit:b,"destroy-on-close":""},{default:t(()=>[e(f,{model:l},{default:t(()=>[e(i,null,{default:t(()=>[e(pl,{modelValue:l.content,"onUpdate:modelValue":v[0]||(v[0]=C=>l.content=C)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512)}}},q=V(0),L=V([]),j=V([]);function fl(r){L.value=r.goodsSkusCard.map(p=>(p.text=p.name,p.loading=!1,p.goodsSkusCardValue.map(u=>(u.text=u.value||"\u5C5E\u6027\u503C",u)),p)),j.value=r.goodsSkus,console.log(j.value)}const oe=V(!1);function gl(){oe.value=!0,Oe({goods_id:q.value,name:"\u89C4\u683C\u9009\u9879",order:50,type:0}).then(r=>{L.value.push({...r,text:r.name,loading:!1,goodsSkusCardValue:[]})}).finally(()=>{oe.value=!1})}function kl(r){r.loading=!0,Fe(r.id,{goods_id:r.goods_id,name:r.text,order:r.order,type:0}).then(p=>{r.name=r.text}).catch(p=>{r.text=r.name}).finally(()=>{r.loading=!1})}function vl(r){r.loading=!0,Ee(r.id).then(p=>{const u=L.value.findIndex(o=>o.id==r.id);u!=-1&&L.value.splice(u,1),J()})}const ne=V(!1);function he(r,p){let u=JSON.parse(JSON.stringify(L.value)),o=r=="up"?tl:al;o(u,p);let l=u.map((y,g)=>({id:y.id,order:g+1}));ne.value=!0,je({sortdata:l}).then(y=>{o(L.value,p),J()}).finally(()=>{ne.value=!1})}function bl(r,p){let u=L.value.find(o=>o.id==r);u.loading=!0,Me(r,p).then(o=>{console.log(o),u.name=u.text=o.goods_skus_card.name,u.goodsSkusCardValue=o.goods_skus_card_value.map(l=>(l.text=l.value||"\u5C5E\u6027\u503C",l)),J()}).finally(()=>{u.loading=!1})}function yl(r){const p=L.value.find(i=>i.id==r),u=V(!1),o=V(""),l=V(!1),y=V();return{item:p,inputValue:o,inputVisible:l,InputRef:y,handleClose:i=>{u.value=!0,He(i.id).then(f=>{let C=p.goodsSkusCardValue.findIndex(z=>z.id===i.id);C!=-1&&p.goodsSkusCardValue.splice(C,1),J()}).finally(()=>{u.value=!1})},showInput:()=>{l.value=!0,ol(()=>{y.value.input.focus()})},handleInputConfirm:()=>{if(!o.value){l.value=!1;return}u.value=!0,Je({goods_skus_card_id:r,name:p.name,order:50,value:o.value}).then(i=>{p.goodsSkusCardValue.push({...i,text:i.value}),J()}).finally(()=>{l.value=!1,o.value="",u.value=!1})},loading:u,handleChange:(i,f)=>{u.value=!0,qe(f.id,{goods_skus_card_id:r,name:p.name,order:f.order,value:i}).then(C=>{f.value=i,J()}).catch(C=>{f.text=f.value}).finally(()=>{u.value=!1})}}}function hl(){const r=ye(()=>L.value.filter(u=>u.goodsSkusCardValue.length>0)),p=ye(()=>{let u=r.value.length;return[{name:"\u5546\u54C1\u89C4\u683C",colspan:u,width:"",rowspan:u>0?1:2},{name:"\u9500\u552E\u4EF7",width:"100",rowspan:2},{name:"\u5E02\u573A\u4EF7",width:"100",rowspan:2},{name:"\u6210\u672C\u4EF7",width:"100",rowspan:2},{name:"\u5E93\u5B58",width:"100",rowspan:2},{name:"\u4F53\u79EF",width:"100",rowspan:2},{name:"\u91CD\u91CF",width:"100",rowspan:2},{name:"\u7F16\u7801",width:"100",rowspan:2}]});return{skuLabels:r,tableThs:p,sku_list:j}}function J(){setTimeout(()=>{if(L.value.length===0)return[];let r=[];if(L.value.forEach(o=>{o.goodsSkusCardValue&&o.goodsSkusCardValue.length>0&&r.push(o.goodsSkusCardValue)}),r.length==0)return[];let p=ll(...r),u=JSON.parse(JSON.stringify(j.value)).map(o=>(Array.isArray(o.skus)||(o.skus=Object.keys(o.skus).map(l=>o.skus[l])),o.skusId=o.skus.sort((l,y)=>l.id-y.id).map(l=>l.id).join(","),o));j.value=[],j.value=p.map(o=>{let l=Vl(JSON.parse(JSON.stringify(o)),u);return{code:(l==null?void 0:l.code)||"",cprice:(l==null?void 0:l.cprice)||"0.00",goods_id:q.value,image:(l==null?void 0:l.image)||"",oprice:(l==null?void 0:l.oprice)||"0.00",pprice:(l==null?void 0:l.pprice)||"0.00",skus:o,stock:(l==null?void 0:l.stock)||0,volume:(l==null?void 0:l.volume)||0,weight:(l==null?void 0:l.weight)||0}})},200)}function Vl(r,p){let u=r.sort((o,l)=>o.id-l.id).map(o=>o.id).join(",");return p.find(o=>r.length>o.skus.length?u.indexOf(o.skusId)!=-1:o.skusId.indexOf(u)!=-1)}const Cl={__name:"SkuCardItem",props:{skuCardId:[Number,String]},setup(r){const p=r,{item:u,inputValue:o,inputVisible:l,InputRef:y,handleClose:g,showInput:b,handleInputConfirm:s,loading:v,handleChange:i}=yl(p.skuCardId);return(f,C)=>{const z=d("el-input"),w=d("el-tag"),G=d("el-button"),S=re("loading");return X((m(),h("div",null,[(m(!0),h($,null,A(a(u).goodsSkusCardValue,(c,R)=>(m(),U(w,{key:R,class:"mx-1",closable:"","disable-transitions":!1,onClose:O=>a(g)(c),effect:"plain"},{default:t(()=>[e(z,{class:"w-20 ml-[-10px]",modelValue:c.text,"onUpdate:modelValue":O=>c.text=O,placeholder:"\u9009\u9879\u503C",size:"small",onChange:O=>a(i)(O,c)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["onClose"]))),128)),a(l)?(m(),U(z,{key:0,ref_key:"InputRef",ref:y,modelValue:a(o),"onUpdate:modelValue":C[0]||(C[0]=c=>nl(o)?o.value=c:null),class:"ml-1 w-20",size:"small",onKeyup:sl(a(s),["enter"]),onBlur:a(s)},null,8,["modelValue","onKeyup","onBlur"])):(m(),U(G,{key:1,class:"button-new-tag ml-1",size:"small",onClick:a(b)},{default:t(()=>[k(" + \u6DFB\u52A0\u9009\u9879\u503C ")]),_:1},8,["onClick"]))])),[[S,a(v)]])}}};const xl={class:"top"},wl=["onClick"],Sl={class:"bottom"},Ul={__name:"ChooseSku",setup(r,{expose:p}){const u=V(!1),o=V(0),{loading:l,currentPage:y,limit:g,total:b,tableData:s,getData:v}=Ce({getList:il,onGetListSuccess:S=>{s.value=S.list,b.value=S.totalCount,s.value.length>0&&w(s.value[0].id)}}),i=V(null),f=(S=null)=>{i.value=S,v(1),u.value=!0},C=V([]),z=Q({name:"",list:[]});function w(S){o.value=S,C.value=[];let c=s.value.find(R=>R.id==S);c&&(C.value=c.default.split(","),z.name=c.name)}const G=()=>{typeof i.value=="function"&&i.value(z),u.value=!1};return p({open:f}),(S,c)=>{const R=d("el-pagination"),O=d("el-aside"),ee=d("el-checkbox"),le=d("el-checkbox-group"),te=d("el-main"),ae=d("el-container"),M=d("el-button"),P=d("el-dialog");return m(),U(P,{title:"\u89C4\u683C\u9009\u62E9",modelValue:u.value,"onUpdate:modelValue":c[2]||(c[2]=D=>u.value=D),width:"80%",top:"5vh"},{footer:t(()=>[x("span",null,[e(M,{onClick:c[1]||(c[1]=D=>u.value=!1)},{default:t(()=>[k("\u53D6\u6D88")]),_:1}),e(M,{type:"primary",onClick:G},{default:t(()=>[k("\u786E\u5B9A")]),_:1})])]),default:t(()=>[e(ae,{style:{height:"65vh"}},{default:t(()=>[e(O,{width:"220px",class:"image-aside"},{default:t(()=>[x("div",xl,[(m(!0),h($,null,A(a(s),(D,K)=>(m(),h("div",{class:ul(["sku-list",{active:o.value==D.id}]),key:K,onClick:ie=>w(D.id)},B(D.name),11,wl))),128))]),x("div",Sl,[e(R,{background:"",layout:"prev, next",total:a(b),"current-page":a(y),"page-size":a(g),onCurrentChange:a(v)},null,8,["total","current-page","page-size","onCurrentChange"])])]),_:1}),e(te,null,{default:t(()=>[e(le,{modelValue:z.list,"onUpdate:modelValue":c[0]||(c[0]=D=>z.list=D)},{default:t(()=>[(m(!0),h($,null,A(C.value,D=>(m(),U(ee,{key:D,label:D,border:""},{default:t(()=>[k(B(D),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};const zl={class:"flex items-center"},$l={__name:"SkuCard",setup(r){const p=V(null),u=o=>{p.value.open(l=>{bl(o.id,{name:l.name,value:l.list})})};return(o,l)=>{const y=d("more"),g=d("el-icon"),b=d("el-input"),s=d("Top"),v=d("el-button"),i=d("Bottom"),f=d("Delete"),C=d("el-popconfirm"),z=d("el-card"),w=d("el-form-item"),G=re("loading");return m(),h($,null,[X((m(),U(w,{label:"\u89C4\u683C\u9009\u9879"},{default:t(()=>[(m(!0),h($,null,A(a(L),(S,c)=>X((m(),U(z,{shadow:"never",class:"w-full mb-3",key:S.id},{header:t(()=>[x("div",zl,[e(b,{modelValue:S.text,"onUpdate:modelValue":R=>S.text=R,placeholder:"\u89C4\u683C\u540D\u79F0",style:{width:"200px"},onChange:R=>a(kl)(S)},{append:t(()=>[e(g,{class:"cursor-pointer",onClick:R=>u(S)},{default:t(()=>[e(y)]),_:2},1032,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),e(v,{class:"ml-auto",size:"small",onClick:R=>a(he)("up",c),disabled:c==0},{default:t(()=>[e(g,null,{default:t(()=>[e(s)]),_:1})]),_:2},1032,["onClick","disabled"]),e(v,{size:"small",onClick:R=>a(he)("down",c),disabled:c===a(L).length-1},{default:t(()=>[e(g,null,{default:t(()=>[e(i)]),_:1})]),_:2},1032,["onClick","disabled"]),e(C,{title:"\u662F\u5426\u8981\u5220\u9664\u8BE5\u9009\u9879\uFF1F",confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",onConfirm:R=>a(vl)(S)},{reference:t(()=>[e(v,{size:"small"},{default:t(()=>[e(g,null,{default:t(()=>[e(f)]),_:1})]),_:1})]),_:2},1032,["onConfirm"])])]),default:t(()=>[e(Cl,{skuCardId:S.id},null,8,["skuCardId"])]),_:2},1024)),[[G,S.loading]])),128)),e(v,{type:"success",size:"small",loading:a(oe),onClick:a(gl)},{default:t(()=>[k("\u6DFB\u52A0\u89C4\u683C\u9009\u9879")]),_:1},8,["loading","onClick"])]),_:1})),[[G,a(ne)]]),e(Ul,{ref_key:"ChooseSkuRef",ref:p},null,512)],64)}}},Rl={class:"border"},Dl=["width","rowspan","colspan"],Il={class:"border"},Ll={class:"border"},Gl={class:"border"},Tl={class:"border"},Bl={class:"border"},Nl={class:"border"},Al={class:"border"},Ol={__name:"SkuTable",setup(r){const{skuLabels:p,tableThs:u,sku_list:o}=hl();return(l,y)=>{const g=d("el-input"),b=d("el-form-item");return m(),U(b,{label:"\u89C4\u683C\u8BBE\u7F6E"},{default:t(()=>[x("table",Rl,[x("thead",null,[x("tr",null,[(m(!0),h($,null,A(a(u),(s,v)=>(m(),h("th",{class:"border",key:v,width:s.width,rowspan:s.rowspan,colspan:s.colspan},B(s.name),9,Dl))),128))]),x("tr",null,[(m(!0),h($,null,A(a(p),(s,v)=>(m(),h("th",{class:"border",key:v},B(s.name),1))),128))])]),x("tbody",null,[(m(!0),h($,null,A(a(o),(s,v)=>(m(),h("tr",{key:v},[(m(!0),h($,null,A(s.skus,(i,f)=>(m(),h("td",{width:"100",class:"border text-center",key:f},B(i.value),1))),128)),x("td",Il,[e(g,{modelValue:s.pprice,"onUpdate:modelValue":i=>s.pprice=i,size:"small",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),x("td",Ll,[e(g,{modelValue:s.oprice,"onUpdate:modelValue":i=>s.oprice=i,size:"small",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),x("td",Gl,[e(g,{modelValue:s.cprice,"onUpdate:modelValue":i=>s.cprice=i,size:"small",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),x("td",Tl,[e(g,{modelValue:s.stock,"onUpdate:modelValue":i=>s.stock=i,size:"small",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),x("td",Bl,[e(g,{modelValue:s.volume,"onUpdate:modelValue":i=>s.volume=i,size:"small",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),x("td",Nl,[e(g,{modelValue:s.weight,"onUpdate:modelValue":i=>s.weight=i,size:"small",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),x("td",Al,[e(g,{modelValue:s.code,"onUpdate:modelValue":i=>s.code=i,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])])]),_:1})}}},Fl={__name:"skus",emits:["reloadData"],setup(r,{expose:p,emit:u}){const o=V(null),l=Q({sku_type:0,sku_value:{oprice:0,pprice:0,cprice:0,weight:0,volume:0}}),y=b=>{q.value=b.id,b.skusLoading=!0,de(q.value).then(s=>{l.sku_type=s.sku_type,l.sku_value=s.sku_value||{oprice:0,pprice:0,cprice:0,weight:0,volume:0},fl(s),o.value.open()}).finally(()=>{b.skusLoading=!1})},g=()=>{o.value.showLoading();let b={sku_type:l.sku_type,sku_value:l.sku_value};l.sku_type==1&&(b.goodsSkus=j.value),Pe(q.value,b).then(s=>{Z("\u8BBE\u7F6E\u5546\u54C1\u89C4\u683C\u6210\u529F"),o.value.close(),u("reloadData")}).finally(()=>{o.value.hideLoading()})};return p({open:y}),(b,s)=>{const v=d("el-radio"),i=d("el-radio-group"),f=d("el-form-item"),C=d("el-input"),z=d("el-form");return m(),U(se,{ref_key:"formDrawerRef",ref:o,title:"\u8BBE\u7F6E\u5546\u54C1\u89C4\u683C",onSubmit:g,"destroy-on-close":"",size:"70%"},{default:t(()=>[e(z,{model:l},{default:t(()=>[e(f,{label:"\u89C4\u683C\u7C7B\u578B"},{default:t(()=>[e(i,{modelValue:l.sku_type,"onUpdate:modelValue":s[0]||(s[0]=w=>l.sku_type=w)},{default:t(()=>[e(v,{label:0},{default:t(()=>[k("\u5355\u89C4\u683C")]),_:1}),e(v,{label:1},{default:t(()=>[k("\u591A\u89C4\u683C")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l.sku_type===0?(m(),h($,{key:0},[e(f,{label:"\u5E02\u573A\u4EF7\u683C"},{default:t(()=>[e(C,{modelValue:l.sku_value.oprice,"onUpdate:modelValue":s[1]||(s[1]=w=>l.sku_value.oprice=w),style:{width:"35%"}},{append:t(()=>[k("\u5143")]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"\u9500\u552E\u4EF7\u683C"},{default:t(()=>[e(C,{modelValue:l.sku_value.pprice,"onUpdate:modelValue":s[2]||(s[2]=w=>l.sku_value.pprice=w),style:{width:"35%"}},{append:t(()=>[k("\u5143")]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"\u6210\u672C\u4EF7\u683C"},{default:t(()=>[e(C,{modelValue:l.sku_value.cprice,"onUpdate:modelValue":s[3]||(s[3]=w=>l.sku_value.cprice=w),style:{width:"35%"}},{append:t(()=>[k("\u5143")]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"\u5546\u54C1\u91CD\u91CF"},{default:t(()=>[e(C,{modelValue:l.sku_value.weight,"onUpdate:modelValue":s[4]||(s[4]=w=>l.sku_value.weight=w),style:{width:"35%"}},{append:t(()=>[k("\u516C\u65A4")]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"\u5546\u54C1\u4F53\u79EF"},{default:t(()=>[e(C,{modelValue:l.sku_value.volume,"onUpdate:modelValue":s[5]||(s[5]=w=>l.sku_value.volume=w),style:{width:"35%"}},{append:t(()=>[k("\u7ACB\u65B9\u7C73")]),_:1},8,["modelValue"])]),_:1})],64)):(m(),h($,{key:1},[e($l),e(Ol)],64))]),_:1},8,["model"])]),_:1},512)}}},El={class:"flex"},jl={class:"flex-1"},Ml={class:"text-rose-500"},Hl={class:"text-gray-500 text-xs"},Jl={class:"text-gray-400 text-xs mb-1"},ql={class:"text-gray-400 text-xs"},Pl={key:0,class:"flex flex-col"},Kl={key:1},Yl={key:0},Wl={key:1},Xl={class:"flex items-center justify-center mt-5"},zt={__name:"list",setup(r){const{handleSelectionChange:p,multipleTableRef:u,handleMultiDelete:o,searchForm:l,resetSearchForm:y,tableData:g,loading:b,currentPage:s,total:v,limit:i,getData:f,handleDelete:C,handleMultiStatusChange:z,multiSelectionIds:w}=Ce({searchForm:{title:"",tab:"all",category_id:null},getList:Ye,onGetListSuccess:I=>{g.value=I.list.map(_=>(_.bannersLoading=!1,_.contentLoading=!1,_.skusLoading=!1,_)),v.value=I.totalCount},delete:We,updateStatus:Xe}),{formDrawerRef:G,formRef:S,form:c,rules:R,drawerTitle:O,handleSubmit:ee,handleCreate:le,handleEdit:te}=cl({form:{title:null,category_id:null,cover:null,desc:null,unit:"\u4EF6",stock:100,min_stock:10,status:1,stock_display:1,min_price:0,min_oprice:0},getData:f,update:Ve,create:Ze}),ae=[{key:"all",name:"\u5168\u90E8"},{key:"checking",name:"\u5BA1\u6838\u4E2D"},{key:"saling",name:"\u51FA\u552E\u4E2D"},{key:"off",name:"\u5DF2\u4E0B\u67B6"},{key:"min_stock",name:"\u5E93\u5B58\u9884\u8B66"},{key:"delete",name:"\u56DE\u6536\u7AD9"}],M=V([]);Ke().then(I=>M.value=I);const P=V(null),D=I=>P.value.open(I),K=V(null),ie=I=>K.value.open(I),ce=V(null),xe=I=>ce.value.open(I),we=()=>me(Qe,"\u6062\u590D"),Se=()=>me(el,"\u5F7B\u5E95\u5220\u9664");function me(I,_){b.value=!0,I(w.value).then(pe=>{Z(_+"\u6210\u529F"),u.value&&u.value.clearSelection(),f()}).finally(()=>{b.value=!1})}return(I,_)=>{const pe=d("el-tab-pane"),Ue=d("el-tabs"),F=d("el-input"),_e=d("el-option"),fe=d("el-select"),T=d("el-button"),ge=d("el-popconfirm"),E=d("el-table-column"),ze=d("el-image"),$e=d("el-divider"),Re=d("el-tag"),De=d("el-table"),Ie=d("el-pagination"),N=d("el-form-item"),Y=d("el-radio"),ke=d("el-radio-group"),Le=d("el-form"),Ge=d("el-card"),Te=re("loading");return m(),h("div",null,[e(Ue,{modelValue:a(l).tab,"onUpdate:modelValue":_[0]||(_[0]=n=>a(l).tab=n),onTabChange:a(f)},{default:t(()=>[(m(),h($,null,A(ae,(n,H)=>e(pe,{label:n.name,name:n.key,key:H},null,8,["label","name"])),64))]),_:1},8,["modelValue","onTabChange"]),e(Ge,{shadow:"never",class:"border-0"},{default:t(()=>[e(Ne,{model:a(l),onSearch:a(f),onReset:a(y)},{show:t(()=>[e(ve,{label:"\u5546\u54C1\u5206\u7C7B"},{default:t(()=>[e(fe,{modelValue:a(l).category_id,"onUpdate:modelValue":_[2]||(_[2]=n=>a(l).category_id=n),placeholder:"\u8BF7\u9009\u62E9\u5546\u54C1\u5206\u7C7B",clearable:""},{default:t(()=>[(m(!0),h($,null,A(M.value,n=>(m(),U(_e,{key:n.id,label:n.name,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),default:t(()=>[e(ve,{label:"\u5173\u952E\u8BCD"},{default:t(()=>[e(F,{modelValue:a(l).title,"onUpdate:modelValue":_[1]||(_[1]=n=>a(l).title=n),placeholder:"\u5546\u54C1\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","onSearch","onReset"]),e(Be,{layout:"create,refresh",onCreate:a(le),onRefresh:a(f)},{default:t(()=>[a(l).tab!="delete"?(m(),U(T,{key:0,type:"danger",size:"small",onClick:a(o)},{default:t(()=>[k("\u6279\u91CF\u5220\u9664")]),_:1},8,["onClick"])):(m(),U(T,{key:1,type:"warning",size:"small",onClick:we},{default:t(()=>[k("\u6062\u590D\u5546\u54C1")]),_:1})),a(l).tab=="delete"?(m(),U(ge,{key:2,title:"\u662F\u5426\u8981\u5F7B\u5E95\u5220\u9664\u8BE5\u5546\u54C1\uFF1F",confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",onConfirm:Se},{reference:t(()=>[e(T,{type:"danger",size:"small"},{default:t(()=>[k("\u5F7B\u5E95\u5220\u9664")]),_:1})]),_:1})):W("",!0),a(l).tab=="all"||a(l).tab=="off"?(m(),U(T,{key:3,size:"small",onClick:_[3]||(_[3]=n=>a(z)(1))},{default:t(()=>[k("\u4E0A\u67B6")]),_:1})):W("",!0),a(l).tab=="all"||a(l).tab=="saling"?(m(),U(T,{key:4,size:"small",onClick:_[4]||(_[4]=n=>a(z)(0))},{default:t(()=>[k("\u4E0B\u67B6")]),_:1})):W("",!0)]),_:1},8,["onCreate","onRefresh"]),X((m(),U(De,{ref_key:"multipleTableRef",ref:u,onSelectionChange:a(p),data:a(g),stripe:"",style:{width:"100%"}},{default:t(()=>[e(E,{type:"selection",width:"55"}),e(E,{label:"\u5546\u54C1",width:"300"},{default:t(({row:n})=>[x("div",El,[e(ze,{class:"mr-3 rounded",src:n.cover,fit:"cover",lazy:!0,style:{width:"50px",height:"50px"}},null,8,["src"]),x("div",jl,[x("p",null,B(n.title),1),x("div",null,[x("span",Ml,"\uFFE5"+B(n.min_price),1),e($e,{direction:"vertical"}),x("span",Hl,"\uFFE5"+B(n.min_oprice),1)]),x("p",Jl,"\u5206\u7C7B:"+B(n.category?n.category.name:"\u672A\u5206\u7C7B"),1),x("p",ql,"\u521B\u5EFA\u65F6\u95F4\uFF1A"+B(n.create_time),1)])])]),_:1}),e(E,{label:"\u5B9E\u9645\u9500\u91CF",width:"70",prop:"sale_count",align:"center"}),e(E,{label:"\u5546\u54C1\u72B6\u6001",width:"100"},{default:t(({row:n})=>[e(Re,{type:n.status?"success":"danger",size:"small"},{default:t(()=>[k(B(n.status?"\u4E0A\u67B6":"\u4ED3\u5E93"),1)]),_:2},1032,["type"])]),_:1}),a(l).tab!="delete"?(m(),U(E,{key:0,label:"\u5BA1\u6838\u72B6\u6001",width:"120",align:"center"},{default:t(({row:n})=>[n.ischeck==0?(m(),h("div",Pl,[e(T,{type:"success",size:"small",plain:""},{default:t(()=>[k("\u5BA1\u6838\u901A\u8FC7")]),_:1}),e(T,{class:"mt-2 !ml-0",type:"danger",size:"small",plain:""},{default:t(()=>[k("\u5BA1\u6838\u62D2\u7EDD")]),_:1})])):(m(),h("span",Kl,B(n.ischeck==1?"\u901A\u8FC7":"\u62D2\u7EDD"),1))]),_:1})):W("",!0),e(E,{label:"\u603B\u5E93\u5B58",width:"90",prop:"stock",align:"center"}),e(E,{label:"\u64CD\u4F5C",align:"center"},{default:t(n=>[a(l).tab!="delete"?(m(),h("div",Yl,[e(T,{class:"px-1",type:"primary",size:"small",text:"",onClick:H=>a(te)(n.row)},{default:t(()=>[k("\u4FEE\u6539")]),_:2},1032,["onClick"]),e(T,{class:"px-1",type:n.row.sku_type==0&&!n.row.sku_value||n.row.sku_type==1&&!n.row.goods_skus.length?"danger":"primary",size:"small",text:"",loading:n.row.skusLoading,onClick:H=>xe(n.row)},{default:t(()=>[k("\u5546\u54C1\u89C4\u683C")]),_:2},1032,["type","loading","onClick"]),e(T,{class:"px-1",type:n.row.goods_banner.length==0?"danger":"primary",size:"small",text:"",onClick:H=>D(n.row),loading:n.row.bannersLoading},{default:t(()=>[k("\u8BBE\u7F6E\u8F6E\u64AD\u56FE")]),_:2},1032,["type","onClick","loading"]),e(T,{class:"px-1",type:n.row.content?"primary":"danger",size:"small",text:"",onClick:H=>ie(n.row),loading:n.row.contentLoading},{default:t(()=>[k("\u5546\u54C1\u8BE6\u60C5")]),_:2},1032,["type","onClick","loading"]),e(ge,{title:"\u662F\u5426\u8981\u5220\u9664\u8BE5\u5546\u54C1\uFF1F",confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",onConfirm:H=>a(C)([n.row.id])},{reference:t(()=>[e(T,{class:"px-1",text:"",type:"primary",size:"small"},{default:t(()=>[k("\u5220\u9664")]),_:1})]),_:2},1032,["onConfirm"])])):(m(),h("span",Wl,"\u6682\u65E0\u64CD\u4F5C"))]),_:1})]),_:1},8,["onSelectionChange","data"])),[[Te,a(b)]]),x("div",Xl,[e(Ie,{background:"",layout:"prev, pager ,next",total:a(v),"current-page":a(s),"page-size":a(i),onCurrentChange:a(f)},null,8,["total","current-page","page-size","onCurrentChange"])]),e(se,{ref_key:"formDrawerRef",ref:G,title:a(O),onSubmit:a(ee)},{default:t(()=>[e(Le,{model:a(c),ref_key:"formRef",ref:S,rules:a(R),"label-width":"80px",inline:!1},{default:t(()=>[e(N,{label:"\u5546\u54C1\u540D\u79F0",prop:"title"},{default:t(()=>[e(F,{modelValue:a(c).title,"onUpdate:modelValue":_[5]||(_[5]=n=>a(c).title=n),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0\uFF0C\u4E0D\u80FD\u8D85\u8FC760\u4E2A\u5B57\u7B26"},null,8,["modelValue"])]),_:1}),e(N,{label:"\u5C01\u9762",prop:"cover"},{default:t(()=>[e(ue,{modelValue:a(c).cover,"onUpdate:modelValue":_[6]||(_[6]=n=>a(c).cover=n)},null,8,["modelValue"])]),_:1}),e(N,{label:"\u5546\u54C1\u5206\u7C7B",prop:"category_id"},{default:t(()=>[e(fe,{modelValue:a(c).category_id,"onUpdate:modelValue":_[7]||(_[7]=n=>a(c).category_id=n),placeholder:"\u9009\u62E9\u6240\u5C5E\u5546\u54C1\u5206\u7C7B"},{default:t(()=>[(m(!0),h($,null,A(M.value,n=>(m(),U(_e,{key:n.id,label:n.name,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(N,{label:"\u5546\u54C1\u63CF\u8FF0",prop:"desc"},{default:t(()=>[e(F,{type:"textarea",modelValue:a(c).desc,"onUpdate:modelValue":_[8]||(_[8]=n=>a(c).desc=n),placeholder:"\u9009\u586B\uFF0C\u5546\u54C1\u5356\u70B9"},null,8,["modelValue"])]),_:1}),e(N,{label:"\u5355\u4F4D",prop:"unit"},{default:t(()=>[e(F,{modelValue:a(c).unit,"onUpdate:modelValue":_[9]||(_[9]=n=>a(c).unit=n),placeholder:"\u8BF7\u8F93\u5165\u5355\u4F4D",style:{width:"50%"}},null,8,["modelValue"])]),_:1}),e(N,{label:"\u603B\u5E93\u5B58",prop:"stock"},{default:t(()=>[e(F,{modelValue:a(c).stock,"onUpdate:modelValue":_[10]||(_[10]=n=>a(c).stock=n),type:"number",style:{width:"40%"}},{append:t(()=>[k("\u4EF6")]),_:1},8,["modelValue"])]),_:1}),e(N,{label:"\u5E93\u5B58\u9884\u8B66",prop:"min_stock"},{default:t(()=>[e(F,{modelValue:a(c).min_stock,"onUpdate:modelValue":_[11]||(_[11]=n=>a(c).min_stock=n),type:"number",style:{width:"40%"}},{append:t(()=>[k("\u4EF6")]),_:1},8,["modelValue"])]),_:1}),e(N,{label:"\u6700\u4F4E\u9500\u552E\u4EF7",prop:"min_price"},{default:t(()=>[e(F,{modelValue:a(c).min_price,"onUpdate:modelValue":_[12]||(_[12]=n=>a(c).min_price=n),type:"number",style:{width:"40%"}},{append:t(()=>[k("\u5143")]),_:1},8,["modelValue"])]),_:1}),e(N,{label:"\u6700\u4F4E\u539F\u4EF7",prop:"min_oprice"},{default:t(()=>[e(F,{modelValue:a(c).min_oprice,"onUpdate:modelValue":_[13]||(_[13]=n=>a(c).min_oprice=n),type:"number",style:{width:"40%"}},{append:t(()=>[k("\u5143")]),_:1},8,["modelValue"])]),_:1}),e(N,{label:"\u5E93\u5B58\u663E\u793A",prop:"stock_display"},{default:t(()=>[e(ke,{modelValue:a(c).stock_display,"onUpdate:modelValue":_[14]||(_[14]=n=>a(c).stock_display=n)},{default:t(()=>[e(Y,{label:0},{default:t(()=>[k("\u9690\u85CF")]),_:1}),e(Y,{label:1},{default:t(()=>[k("\u663E\u793A")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(N,{label:"\u662F\u5426\u4E0A\u67B6",prop:"status"},{default:t(()=>[e(ke,{modelValue:a(c).status,"onUpdate:modelValue":_[15]||(_[15]=n=>a(c).status=n)},{default:t(()=>[e(Y,{label:0},{default:t(()=>[k("\u653E\u5165\u4ED3\u5E93")]),_:1}),e(Y,{label:1},{default:t(()=>[k("\u7ACB\u5373\u4E0A\u67B6")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","onSubmit"])]),_:1}),e(ml,{ref_key:"bannersRef",ref:P,onReloadData:a(f)},null,8,["onReloadData"]),e(_l,{ref_key:"contentRef",ref:K,onReloadData:a(f)},null,8,["onReloadData"]),e(Fl,{ref_key:"skusRef",ref:ce,onReloadData:a(f)},null,8,["onReloadData"])])}}};export{zt as default};
