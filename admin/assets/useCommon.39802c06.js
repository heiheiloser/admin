import{t as m}from"./index.73635d93.js";import{a2 as b,r as i,p as L}from"./@vue.81e65c16.js";function M(e={}){let u=null,c=null;e.searchForm&&(u=b({...e.searchForm}),c=()=>{for(const a in e.searchForm)u[a]=e.searchForm[a];r()});const f=i([]),l=i(!1),d=i(1),s=i(0),S=i(10);function r(a=null){typeof a=="number"&&(d.value=a),l.value=!0,e.getList(d.value,u).then(n=>{e.onGetListSuccess&&typeof e.onGetListSuccess=="function"?e.onGetListSuccess(n):(f.value=n.list,s.value=n.totalCount)}).finally(()=>{l.value=!1})}r();const v=a=>{l.value=!0,e.delete(a).then(n=>{m("\u5220\u9664\u6210\u529F"),r()}).finally(()=>{l.value=!1})},g=(a,n)=>{n.statusLoading=!0,e.updateStatus(n.id,a).then(C=>{m("\u4FEE\u6539\u72B6\u6001\u6210\u529F"),n.status=a}).finally(()=>{n.statusLoading=!1})},h=i([]),o=a=>{h.value=a.map(n=>n.id)},t=i(null);return{searchForm:u,resetSearchForm:c,tableData:f,loading:l,currentPage:d,total:s,limit:S,getData:r,handleDelete:v,handleStatusChange:g,handleSelectionChange:o,multipleTableRef:t,handleMultiDelete:()=>{l.value=!0,e.delete(h.value).then(a=>{m("\u5220\u9664\u6210\u529F"),t.value&&t.value.clearSelection(),r()}).finally(()=>{l.value=!1})},handleMultiStatusChange:a=>{l.value=!0,e.updateStatus(h.value,a).then(n=>{m("\u4FEE\u6539\u72B6\u6001\u6210\u529F"),t.value&&t.value.clearSelection(),r()}).finally(()=>{l.value=!1})},multiSelectionIds:h}}function G(e={}){const u=i(null),c=i(null),f=e.form,l=b({}),d=e.rules||{},s=i(0),S=L(()=>s.value?"\u4FEE\u6539":"\u65B0\u589E"),r=()=>{c.value.validate(o=>{if(!o)return;u.value.showLoading();let t={};e.beforeSubmit&&typeof e.beforeSubmit=="function"?t=e.beforeSubmit({...l}):t=l,(s.value?e.update(s.value,t):e.create(t)).then(F=>{m(S.value+"\u6210\u529F"),e.getData(s.value?!1:1),u.value.close()}).finally(()=>{u.value.hideLoading()})})};function v(o=!1){c.value&&c.value.clearValidate();for(const t in f)l[t]=o[t]}return{formDrawerRef:u,formRef:c,form:l,rules:d,editId:s,drawerTitle:S,handleSubmit:r,resetForm:v,handleCreate:()=>{s.value=0,v(f),u.value.open()},handleEdit:o=>{s.value=o.id,v(o),u.value.open()}}}export{G as a,M as u};
